@model LEMS.Models.Equipment

@{
    ViewData["Title"] = "Equipment Details";
}

<style>
    .equipment-card {
        background: linear-gradient(145deg, #f8f9fa, #ffffff);
        border: none;
        border-radius: 1.5rem;
        box-shadow: 0 8px 20px rgba(0,0,0,0.08);
    }

    .equipment-img {
        border-radius: 1rem;
        object-fit: cover;
        max-height: 250px;
        border: 4px solid #f1f1f1;
    }

    .section-title {
        font-weight: 700;
        color: #0d6efd;
        letter-spacing: 1px;
    }

    .dl-label {
        font-weight: 600;
        color: #555;
    }

    .btn-glow {
        box-shadow: 0 5px 10px rgba(0,0,0,0.1);
        border-radius: 0.75rem;
        padding: 10px 20px;
    }

    .modal-content {
        border-radius: 1rem;
    }

    .badge {
        font-size: 0.9rem;
        padding: 6px 12px;
        border-radius: 1rem;
    }
</style>

<div class="container mt-5 mb-5">
    <div class="card equipment-card p-4">
        <div class="row g-4 align-items-start">
            <!-- LEFT: Equipment Info -->
            <div class="col-lg-7">
                <h2 class="section-title mb-4">📋 Equipment Details</h2>
                <dl class="row fs-6">
                    <dt class="col-sm-5 dl-label">Name</dt>
                    <dd class="col-sm-7">@Model.Name</dd>

                    <dt class="col-sm-5 dl-label">Measurement Unit</dt>
                    <dd class="col-sm-7">@Model.MeasurmentUnit</dd>

                    <dt class="col-sm-5 dl-label">Code</dt>
                    <dd class="col-sm-7">@Model.Code</dd>

                    <dt class="col-sm-5 dl-label">Description</dt>
                    <dd class="col-sm-7">@Model.Discription</dd>

                    <dt class="col-sm-5 dl-label">Is Active</dt>
                    <dd class="col-sm-7">
                        <span class="badge @(Model.IsActive ? "bg-success" : "bg-secondary")">
                            @(Model.IsActive ? "Active" : "Inactive")
                        </span>
                    </dd>

                    <dt class="col-sm-5 dl-label">Is Deleted</dt>
                    <dd class="col-sm-7">
                      @*   <span class="badge @(Model.IsDeleted ? "bg-danger" : "bg-info")">
                            @(Model.IsDeleted ? "Deleted" : "Available")
                        </span> *@
                    </dd>

                    <dt class="col-sm-5 dl-label">Equipment Type</dt>
                    <dd class="col-sm-7">@Model.EquipmentsType?.Id</dd>
                </dl>

                <div class="mt-4">
                    <a class="btn btn-outline-primary btn-glow me-2" asp-action="Edit" asp-route-id="@Model.Id">
                        ✏️ Edit Details
                    </a>
                    <a class="btn btn-outline-secondary btn-glow" asp-action="Index">
                        🔙 Back to List
                    </a>
                </div>
            </div>

            <!-- RIGHT: Image + Actions -->
            <div class="col-lg-5 text-center">
                <div class="bg-white shadow-sm p-3 rounded-4">
                    <img src="@Model.PhotoUrl"
                         onerror="this.onerror=null;this.src='/images/default-equipment.png';"
                         class="img-fluid equipment-img mb-3"
                         alt="Equipment Image" />
                    <p class="text-muted">📷 Current Equipment Image</p>
                </div>

                <div class="d-grid gap-2 mt-4">
                    <button class="btn btn-success btn-glow" data-bs-toggle="modal" data-bs-target="#uploadImageModal">
                        ⬆️ Upload Image
                    </button>
                    <button class="btn btn-warning btn-glow" data-bs-toggle="modal" data-bs-target="#editImageModal">
                        ✏️ Replace Image
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Upload Image Modal -->
<div class="modal fade" id="uploadImageModal" tabindex="-1" aria-labelledby="uploadImageModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <form asp-action="UploadImage" asp-controller="Equipments" method="post" enctype="multipart/form-data">
                <div class="modal-header">
                    <h5 class="modal-title">📤 Upload Image</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" name="id" value="@Model.Id" />
                    <div class="mb-3">
                        <label for="photoUpload" class="form-label">Choose Image</label>
                        <input type="file" class="form-control" id="photoUpload" name="photo" accept="image/*" required />
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-success">Upload</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Edit Image Modal -->
<div class="modal fade" id="editImageModal" tabindex="-1" aria-labelledby="editImageModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <form asp-action="EditImage" asp-controller="Equipments" method="post" enctype="multipart/form-data">
                <div class="modal-header bg-warning bg-opacity-75">
                    <h5 class="modal-title">✏️ Replace Existing Image</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" name="id" value="@Model.Id" />
                    <div class="mb-3">
                        <label for="photoEdit" class="form-label">Select New Image</label>
                        <input type="file" class="form-control" id="photoEdit" name="photo" accept="image/*" required />
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-warning">Replace</button>
                </div>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
}
